AWSTemplateFormatVersion: "2010-09-09"
Resources:
    MFAPolicy:
        Type: AWS::IAM::ManagedPolicy
        Properties:
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              -    
                Sid: AllowIndividualUserToManageTheirOwnMFA
                Effect: Allow
                Action:
                  - 'iam:CreateVirtualMFADevice'
                  - 'iam:DeactivateMFADevice'
                  - 'iam:DeleteVirtualMFADevice'
                  - 'iam:RequestSmsMfaRegistration'
                  - 'iam:FinalizeSmsMfaRegistration'
                  - 'iam:EnableMFADevice'
                  - 'iam:ResyncMFADevice'
                Resource:
                    - 'arn:aws:iam::192068749412:mfa/${aws:ADMIN}'
                    - 'arn:aws:iam::192068749412:user/${aws:ADMIN}'
                Condition:
                  Bool:
                    aws:MultiFactorAuthPresent: 'true'
              -
                Sid: AllowUsersToListMFADevicesandUsersForConsole
                Effect: Allow
                Action:
                     - 'iam:ListMFADevices'
                     - 'iam:ListVirtualMFADevices'
                     - 'iam:ListUsers'
                Resource: '*'
